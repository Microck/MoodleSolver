# MoodleSolver Extension

**Version:** 1.5.2 (as per last file versions)

A browser extension designed to aid in the analysis and interaction with web-based assessments, particularly those on Moodle platforms. It allows users to scrape question data, leverage AI services (OpenAI, Google Gemini, AIMLAPI.com) to determine answers, and automate interactions. This tool is intended for educational, research, or security testing purposes on platforms where you have explicit permission to conduct such automated testing.

**Disclaimer:** *This tool automates interactions with web pages and AI services. Users are solely responsible for ensuring their use complies with the terms of service of any targeted website (e.g., Moodle instances) and any AI service provider. Misuse of this tool for academic dishonesty or unauthorized activities is strictly discouraged and is the responsibility of the user. API keys for AI services are required and are subject to the respective provider's terms and usage limits.*

![MoodleSolver](https://github.com/user-attachments/assets/c2767922-2b69-4135-bbc7-6394e9e9c3a2)

## Core Features

*   **Multi-Page Quiz Data Acquisition (`Alt+Shift+I`):**
    *   Navigates through all pages of a Moodle quiz.
    *   Scrapes question text and multiple-choice options from each page.
    *   **Batch AI Processing:** Sends all scraped questions in a **single, consolidated prompt** to the configured AI service (OpenAI, Google Gemini, or AIMLAPI.com).
    *   Parses the AI's batch response to determine a suggested answer for each question.
    *   Stores all scraped data and AI-determined answers locally for subsequent actions.
*   **Targeted Answer Selection (`Alt+Shift+X`):**
    *   Identifies the question currently displayed on the Moodle quiz page.
    *   Retrieves the pre-calculated AI answer for that specific question from the stored data (generated by `Alt+Shift+I`).
    *   Automatically selects the corresponding answer option on the webpage.
    *   If data hasn't been fully processed, this command will trigger the full data acquisition and batch AI processing first.
*   **Data Readiness Check (`Alt+Shift+C`):**
    *   Ensures that all quiz questions have been scraped and processed by the AI in a batch. Triggers the full process if needed.
    *   This command does not directly interact with the webpage to select answers.
*   **Clear Stored Data (`Alt+Shift+R`):**
    *   Allows users to clear all locally stored quiz data, including scraped questions and AI-determined answers. This is useful for forcing a fresh scrape and AI processing run.
*   **Configurable AI Services & Settings:**
    *   Supports user-provided API keys for OpenAI, Google Gemini, and AIMLAPI.com.
    *   Allows model selection for AIMLAPI.com (e.g., 'gpt-4o-mini').
    *   Option to configure the delay between page navigations during the multi-page scraping process.
*   **In-Popup Debugging:**
    *   Provides a debug log within the extension's popup to monitor operations and troubleshoot issues.

## Installation Guide (for Chrome/Chromium-based browsers)

1.  **Download/Clone:** Obtain all extension files. The necessary files include:
    *   `manifest.json`
    *   `background.js`
    *   `content_script.js`
    *   `options.html`
    *   `options.js`
    *   `popup.html`
    *   `popup.js`
    *   `styles.css`
    *   `images` folder
2.  **Open Extensions Page:** In your browser, type `chrome://extensions` into the address bar and press Enter.
3.  **Enable Developer Mode:** Locate the "Developer mode" toggle (usually in the top-right corner) and switch it ON.
4.  **Load Unpacked Extension:**
    *   Click the "Load unpacked" button.
    *   In the file dialog, navigate to the folder containing all the MoodleSolver extension files and select this folder.
5.  **Verify Installation:** The "MoodleSolver" extension should now appear in your list of installed extensions, and its icon should be visible in your browser's toolbar.

## Configuration Steps

**Crucial:** You must configure an AI service and provide an API key before the AI-related features will work.

1.  **Access Options Page:**
    *   Right-click the MoodleSolver icon in your browser toolbar and select "Options".
    *   Alternatively, go to `chrome://extensions`, find MoodleSolver, click "Details", then "Extension options".
2.  **Set Inter-Page Delay:**
    *   Enter a value (in milliseconds) for the "Inter-Page Scraping Delay". This controls the pause between navigating to each new page when using the `Alt+Shift+I` command. Recommended starting values are between 500ms and 1500ms. Adjust based on your Moodle site's responsiveness.
3.  **Choose AI Service:**
    *   Select your preferred AI provider from the "Select AI Service" dropdown (OpenAI, Google Gemini, AIMLAPI.com).
4.  **Enter API Key(s):**
    *   Input your valid API key into the field corresponding to your chosen service.
    *   If using AIMLAPI.com, also select your desired model (e.g., `gpt-4o-mini`) from its dropdown. Ensure the model identifier is exactly as provided by AIMLAPI.com.
5.  **Save:** Click the "Save Configuration" button. You should see a confirmation message.

**Important Notes on AI Services:**
*   API keys are sensitive. Handle them with care.
*   You are responsible for adhering to the terms, usage limits, and potential costs associated with your chosen AI service provider and plan. Free tiers often have strict limitations on requests or token usage.
*   The "Batch AI Processing" feature makes only **one API call** for all questions in a quiz, which is beneficial for per-request rate limits. However, this single request will contain many tokens. Ensure your chosen model's context window can accommodate the entire quiz.
*   The accuracy of AI-suggested answers depends on the AI model's capabilities and the clarity of the quiz questions.

## How to Use MoodleSolver (Hotkeys)

All primary functions are triggered by hotkeys when you are on an active Moodle quiz page.

*   **`Alt+Shift+I`**: **Get All Test Data & Process with AI (Batch)**
    *   **Action:** This is the main command to run first on a quiz. It navigates through all quiz pages, scrapes all questions/options, sends them *all in a single batch prompt* to the AI, parses the AI's batch response, and stores all results.
    *   **Use Case:** Run this once at the start of a quiz session to prepare all data.

*   **`Alt+Shift+X`**: **Select AI Answer for Current Page**
    *   **Action:** Identifies the question on the currently viewed page, retrieves its pre-calculated AI answer (from the data prepared by `Alt+Shift+I`), and automatically clicks the corresponding answer option on the page.
    *   **Use Case:** After running `Alt+Shift+I`, navigate to any question page and use this to select the AI's answer.

*   **`Alt+Shift+C`**: **Ensure All Data Processed**
    *   **Action:** Triggers the same full data scraping and batch AI processing as `Alt+Shift+I` if the data isn't already considered complete and valid in storage.
    *   **Use Case:** A way to force or confirm that all data is ready without directly interacting with the current page's answers.

*   **`Alt+Shift+R`**: **Clear Stored Quiz Data**
    *   **Action:** Deletes all locally stored `quizData`, `totalQuestions`, and `processedQuizData` for the extension.
    *   **Use Case:** Use this to force a completely fresh scrape and AI processing run on the next use of `Alt+Shift+I`, `Alt+Shift+X`, or `Alt+Shift+C`. Essential for re-testing or if you suspect stored data is stale.

## Troubleshooting

*   **Extension Not Working / Greyed Out:**
    *   Check `chrome://extensions` for any errors listed under MoodleSolver. Pay attention to manifest errors or background script errors.
    *   Ensure all files, including the `images` folder with icons, are correctly placed in the extension directory.
*   **Hotkeys Unresponsive:**
    *   Make sure the Moodle quiz page tab is active and has browser focus.
    *   Check the background script's console for errors when a command should be firing. (Access via `chrome://extensions` -> MoodleSolver -> "Service worker").
*   **Data Scraping Issues (e.g., wrong number of questions/options, no data):**
    *   The CSS selectors in `content_script.js` (functions `scrapeAllQuizDataInternal` and `scrapeCurrentQuestionDataInternal`) are tailored to a specific Moodle HTML structure. Different Moodle themes or versions may require these selectors to be adjusted. This is the most common point of failure for scraping. Inspect the Moodle page's HTML and compare.
    *   Check the content script console (on the Moodle page: `Ctrl+Shift+J` or `Cmd+Option+J`) for errors.
*   **AI Errors / No AI Answers:**
    *   Verify API key and selected model in the extension's Options page.
    *   Check the debug log in the extension popup for API error messages (e.g., rate limits, invalid key, model not found, context window exceeded for batch prompt).
    *   Ensure your AI service plan allows access to the selected model and has sufficient quota.
*   **"Receiving end does not exist" (Background Console Error):**
    *   Often indicates an issue in `content_script.js` where an asynchronous message handler does not `return true;` or an unhandled error prevents `sendResponse` from being called.

